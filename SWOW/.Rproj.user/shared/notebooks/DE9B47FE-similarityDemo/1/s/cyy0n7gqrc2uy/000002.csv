"0","# The following lines of code are a bit more advanced and rely on the broom package."
"0","# see https://cran.r-project.org/web/packages/broom/vignettes/broom_and_dplyr.html"
"0","# Basically we nest the data to apply a correlation test to each dataset, and "
"0","# tidy it so we get all test statistics in a clean dataframe."
"0","# Add to the original ratings"
"0","X.results = inner_join(X.ratings,X.sim, by = c('WordA','WordB'))"
"0",""
"0","X.r = X.results %>% nest(data = -dataset) %>% "
"0","  mutate(r_strength = map(data, ~ cor.test(.x$Rating,.x$cos_strength)),"
"0","        r_strength = map(r_strength, tidy)) %>% "
"0","  mutate(r_ppmi = map(data, ~ cor.test(.x$Rating,.x$cos_ppmi)),"
"0","        r_ppmi = map(r_ppmi, tidy)) %>%"
"0","  mutate(r_rw = map(data, ~ cor.test(.x$Rating,.x$cos_rw)),"
"0","        r_rw = map(r_rw, tidy))"
"0","  "
"0","X.r = X.r %>% unnest(cols = c(r_strength,r_ppmi,r_rw), names_sep = '.')"
"0",""
"0","print(X.r %>% mutate(r.strength = round(r_strength.estimate,3),"
"0","                            r.ppmi = round(r_ppmi.estimate,3), "
"0","                            r.rw = round(r_rw.estimate,3)) %>% "
"0","        select(dataset,r.strength,r.ppmi,r.rw))"
