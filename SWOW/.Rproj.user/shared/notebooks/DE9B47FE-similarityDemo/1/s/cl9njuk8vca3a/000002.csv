"0","# Look up forward and backward associative strength"
"0","# Note: here we're indexing on a full graph, which means this needs to fit in memory"
"0","tmp.strength = as.array(igraph::as_adjacency_matrix(G.strength,attr='weight',names = TRUE))"
"0","tmp.ppmi = as.array(igraph::as_adjacency_matrix(G.ppmi,attr='weight',names = TRUE))"
"0","tmp.rw  = as.array(igraph::as_adjacency_matrix(G.rw,attr='weight',names = TRUE))"
"0",""
"0","X.asso = tibble('WordA' =pairs$WordA, 'WordB' = pairs$WordB,"
"0","                 'fw_strength' = tmp.strength[cbind(pairs$WordA,pairs$WordB)],"
"0","                 'fw_ppmi' = tmp.ppmi[cbind(pairs$WordA,pairs$WordB)],"
"0","                 'fw_rw' = tmp.rw[cbind(pairs$WordA,pairs$WordB)],"
"0","                 'bw_strength' = tmp.strength[cbind(pairs$WordB,pairs$WordA)],"
"0","                 'bw_ppmi' = tmp.ppmi[cbind(pairs$WordB,pairs$WordA)],"
"0","                 'bw_rw' = tmp.rw[cbind(pairs$WordB,pairs$WordA)])"
"0",""
"0",""
"0","# Add to the original ratings"
"0","X.resultsA = inner_join(X.ratings,X.asso, by = c('WordA','WordB'))"
"0",""
"0","# Ignore strength = 0 "
"0","X.resultsA = X.resultsA %>% filter(fw_strength > 0, fw_ppmi > 0, fw_rw >0)"
"0",""
"0","X.rFW = X.resultsA %>% nest(data = -dataset) %>% "
"0","  mutate(fw_strength = map(data, ~ cor.test(.x$Rating,.x$fw_strength)),"
"0","        fw_strength = map(fw_strength, tidy),"
"0","        fw_ppmi = map(data, ~ cor.test(.x$Rating,.x$fw_ppmi)),"
"0","        fw_ppmi = map(fw_ppmi, tidy),"
"0","        fw_rw = map(data, ~ cor.test(.x$Rating,.x$fw_rw)),"
"0","        fw_rw = map(fw_rw, tidy))"
"0","  "
"0","X.rFW = X.rFW %>% unnest(cols = c(fw_strength,fw_ppmi,fw_rw), names_sep = '.')"
"0",""
"0","# Only keep datasets with at least 40 observations"
"0","print(X.rFW %>% mutate(r.strength = round(fw_strength.estimate,3),"
"0","                            r.ppmi = round(fw_ppmi.estimate,3), "
"0","                            r.rw = round(fw_rw.estimate,3)) %>% "
"0","        select(dataset,parameter = fw_strength.parameter,r.strength,r.ppmi,r.rw) %>%"
"0","        filter(parameter > 40))"
